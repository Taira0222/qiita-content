---
title: 【ネットワーク】ICMP
tags:
  - Network
  - 初心者
  - 未経験エンジニア
  - ICMP
  - 独学
private: false
updated_at: '2025-04-24T12:04:16+09:00'
id: a7c589136880e593e39d
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに

こんにちは。アメリカに住みながら、独学でエンジニアを目指しているTairaです。
今回はネットワーク通信における重要な制御プロトコル「ICMP」について解説します。

---

## ICMPとは何か？

ICMP（Internet Control Message Protocol）とは、インターネット層（OSI参照モデルではネットワーク層）で使用される**制御用の通信プロトコル**です。TCPやUDPのようにアプリケーションのデータを運ぶことはなく、通信の成功や失敗、状態の異常などを通知することに特化しています。

たとえるなら、ICMPは通信の"伝令係"。パケットを届ける役目を担うわけではありませんが、「届かなかった」「経路に問題がある」などを伝えてくれます。

---

## ICMPの役割と位置づけ

ICMPは、IP（Internet Protocol）と同じ"ネットワーク層"に位置しています。TCPやUDPがデータ転送を担う"トランスポート層"の上位にあるのに対し、ICMPはIPと一体で動作し、通信の制御や通知を行います。

```
[アプリケーション層]  → Web、メールなどの処理
[トランスポート層]    → TCP、UDP
[ネットワーク層]       → IP + ICMP  ← ★ここ！
[データリンク層]       → イーサネットなど
```

ICMPは、IPパケット内に埋め込まれた形で動作し、通信の補助的な役割を果たします。

---

## ICMPが使われる具体的な場面

以下に、ICMPが送信する代表的なメッセージと、それが使われる場面を紹介します。

| タイプ | 名称 | 使われる場面 |
|--------|------|----------------|
| 3 | Destination Unreachable | 宛先のIPに到達できないとき |
| 11 | Time Exceeded | パケットのTTLがゼロになり廃棄されたとき |
| 5 | Redirect | より適切なルートがあるときに経路変更を促す |
| 12 | Parameter Problem | パケット内の情報に問題があるとき |

これらの通知は、アプリケーション層のプロトコル（HTTPやSMTPなど）では得られない"通信インフラの状態"を知る上で極めて重要です。

---

## pingコマンドとの関係
ICMPが実際に使われている最も身近な例が、pingコマンドです。

pingはICMPの**Echo Request（エコー要求）メッセージを送信し、相手からのEcho Reply（エコー応答）**を受け取ることで、以下のことを確認します

- 相手のホストがネットワーク上で生きているか
- 通信にかかる時間（ラウンドトリップタイム）
- パケットロスの有無
- DNAが正しく動いているか

たとえば、以下のように使います
```bash
ping google.com
```
このようにして送られたICMPメッセージに相手が応答すれば「生きている」と判断でき、返答がなければ「通信できない」ことを示します。

なお、pingが動作しないからといって必ずしも相手が落ちているとは限りません。ICMPをファイアウォールなどでブロックしているケースもあるため、その点も注意が必要です。
また、 pingはサーバーの「存在」と「到達性」を確認するだけでWebにアクセスできるかどうかはわかりません。
## ICMPの重要性

ICMPがなければ、通信の失敗がどこで起きているのかを知る手段がありません。例えば：
- 宛先が存在しない：ICMPが"到達不可"を通知
- 途中のルーターでTTLが尽きた：ICMPが"時間超過"を通知
- 経路が混雑している：ICMPが"経路変更"を提案

これらはすべて、ネットワークの診断やトラブルシューティングに欠かせない情報です。

---

## セキュリティとの関係

便利なICMPですが、ネットワークの構成や存在を探る手段として悪用されることもあります。そのため、ファイアウォールやルーターでICMPを制限・遮断する設定がされていることもあります。

---

## まとめ

| 項目 | 内容 |
|------|------|
| 名称 | Internet Control Message Protocol |
| 役割 | 通信の制御、エラー通知、経路案内など |
| 層 | ネットワーク層（IPと同じ） |
| 主なメッセージ | 宛先到達不能、時間超過、経路変更、パラメータエラー、エコー要求/応答（ping）など





