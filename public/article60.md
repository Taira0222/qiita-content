---
title: '【Ruby】コードを通してFile::Statの使い方を学ぶ'
tags:
  - Ruby
  - 初心者
  - stat
  - 未経験エンジニア
  - 独学
private: false
updated_at: '2024-11-27T08:35:59+09:00'
id: dda9cae919fd4eaf4d3d
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに
こんにちは！アメリカの大学で語学を学びながら、独学でソフトウェアエンジニアを目指している者です。
現在Fileクラスについて勉強していますが、その中でも`File::Stat`について解説していこうと思います。

この記事では、`File::Stat` クラスを使ったファイル属性の取得方法や、代表的なインスタンスメソッドの使い方をわかりやすく紹介します。

# `File::Stat`とは？
`File::Stat` は、ファイルやディレクトリに関する属性（サイズやタイムスタンプ、権限など）を取得するためのクラスです。
Rubyでは以下のように `File.stat` クラスメソッドを使って `File::Stat` のインスタンスを取得できます。
```ruby
stat = File.stat("example.txt")
```
ここで得られる `stat` は `File::Stat` クラスのインスタンスであり、さまざまな情報を取得できるメソッドが用意されています。

## 基本的な使い方
まずは `File::Stat` を使った簡単な例を見てみましょう。
```ruby
filename = "example.txt"

# ファイルを作成
File.write(filename, "Rubyでファイル属性を取得する練習")

# ファイルの属性を取得
stat = File.stat(filename)

# 属性を確認
puts "ファイルサイズ: #{stat.size} バイト"
puts "最終更新日時: #{stat.mtime}"
puts "読み取り可能: #{stat.readable?}"
puts "書き込み可能: #{stat.writable?}"
puts "実行可能: #{stat.executable?}"
```
出力はいかの通りです
```ruby
ファイルサイズ: 27 バイト
最終更新日時: 2024-11-24 12:00:00 +0000
読み取り可能: true
書き込み可能: true
実行可能: false
```

### 代表的な`File::Stat`のメソッド
以下は、`File::Stat` クラスでよく使われるインスタンスメソッドの一覧です。
| 　メソッド名　| 説明                                                          | 
|:-------------|:-------------------------------------------------------|
| `size`       |ファイルのサイズ（バイト数）を返す    |
|  `file?`    |通常ファイルであれば true を返す                           |
|`directory?` | ディレクトリであれば true を返す                      |	
|`readable?` |  読み取り可能であれば true を返す                  |	
|  `writable?`   | 書き込み可能であれば true を返す              |  
| `executable? `   |	  実行可能であれば true を返す |  
| `atime `   |	最後にアクセスした時刻を返す   |  
| `mtime `   |	最後に内容を変更した時刻を返す   |  
| `ctime `   |	メタデータを最後に変更した時刻を返す   |  
| `mode `   |	ファイルモード（パーミッション情報）を返す   |  
| `uid `   |ファイル所有者のユーザーIDを返す	   |  
| `gid `   |ファイル所有者のグループIDを返す	   |  

## ファイルモードを操作する例
次に、`File::Stat` を使ってファイルのモード（権限）を取得し、変更する方法を紹介します。
以下の例では、既存のファイルに実行権限を追加します。
```ruby
filename = "example.txt"
stat = File.stat(filename)

# 現在のファイルモードを取得
puts "現在のモード: #{stat.mode.to_s(8)}"

# 実行権限を追加
File.chmod(stat.mode | 0111, filename)

# 更新後のモードを確認
stat = File.stat(filename)
puts "更新後のモード: #{stat.mode.to_s(8)}"
```
出力例は以下の通りです
```ruby
現在のモード: 100644
更新後のモード: 100755
```
コードの解説は以下の通りです
* ファイルモード（パーミッション）
ファイルモードは 8 進数で表され、100644 は通常の読み書き可能なファイル、100755 は実行権限が追加されたファイルを表します。

* `File.chmod`
ファイルの権限を変更するメソッドです。上記の例では `|` 演算子を使い、既存のモードに実行権限を追加しました。

この方法を活用することで、スクリプト内で柔軟にファイル権限を変更できます。

# まとめ
`File::Stat` は、ファイルやディレクトリの属性を簡単に取得できる強力なクラスです。
特に、ファイルモードやタイムスタンプの取得、パーミッションの確認など、ファイル操作において非常に便利です。

今後は、この記事で取り上げた `File.chmod` や、ファイルのパーミッションに関連する詳細な操作についても解説記事を書く予定ですので、ぜひ楽しみにしていてください！
