---
title: 【Ruby】レシーバとは
tags:
  - Ruby
  - 初心者
  - 未経験エンジニア
  - レシーバ
  - 未経験からWeb系
private: false
updated_at: '2024-10-27T01:32:59+09:00'
id: 5fa71da3f9a6ba8d88ba
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに
こんにちは、現在アメリカの大学に行って語学を学びながらソフトウェアエンジニアになるために独学で勉強しているものです。
本日はRubyを勉強しているとよく出てくる、メソッドについて整理していきます。
というのも、現在progate→ゼロから分かるRuby→たのしいRubyと段階を追って勉強しているのですが、レシーバについて詳しく触れる機会がなく何となくでここまで進んでしまっているので
`rails`に入る前に定義をしっかり確立していきたいと思います。

# レシーバ
レシーバとは、メソッドが呼び出される際に、そのメソッドを実行するオブジェクトです。
オブジェクト指向プログラミングでは、オブジェクトが持つメソッドを呼び出す際、どのオブジェクトに対してメソッドを実行するのかをレシーバが決定します。

```ruby:receiver1.rb
str = "hello"   # str は String クラスのオブジェクト
str.upcase      # str がレシーバとなり、upcase メソッドが呼ばれる
```
ここでは、`hello`というStringオブジェクトが`upcase`メソッドを呼び出しています。
この場合、`str`がレシーバです。メソッドがレシーバに対して何らかの操作を行い、その結果が返されます。

# selfとは
次に、 `self`について説明します。
`self`は、<strong>そのメソッドが実行されるオブジェクト、もしくはクラスを指す特殊な変数です</strong>
`self`は現在のレシーバ（メソッドを呼び出しているオブジェクト）であるということと省略できる場合があります。
できない場合も後で説明するのでまずはこの2つを覚えておいてください。
まずは省略できるケースから紹介します

### selfが省略できるケース
```ruby:self1.rb
class Person
  def greet
    puts "Hello!"
  end

  def welcome
    greet  # ここでのgreetはself.greetと同じ意味
  end
end

person = Person.new
person.welcome  # => "Hello!"
```
この例では、`welcome`メソッド内で`greet`メソッドを呼び出していますが、`greet`の前に何もレシーバを書いていません。
先ほど`self`は現在のレシーバ（メソッドを呼び出しているオブジェクト）であると言っていたのに、、と思うかもしれませんが一回説明を聞いてくださいw
`greet`はインスタンスメソッドであり、これを呼び出すためには`person.greet`と呼び出す必要があります。
それはwelcomeの中でもそうなのですが、この場合は現在のレシーバ（メソッドを呼び出しているオブジェクト）である`self`を使用します。
英語でいう代名詞みたいなもので、例えば「Mike is kind. Mike has two brothers」とは言わずに「Mike is kind. He has two brothers」といいますよね。
Mikeという人の名前を繰り返し避けるためにHeを使用していますが、`self`も`person`インスタンスを置き換えているという点では似ています

では話を戻します。Rubyはインスタンスメソッド内では、同じクラス内の他のインスタンスメソッドを呼び出す際に`self`を省略できます。
なので`greet`を`self.greet`と解釈してくれます。
この場合、`self`は`Person`クラスのインスタンスである`person`を指しています。
つまり、greetメソッドを呼び出しているのは`self`、つまり`person`というオブジェクトです。

### selfが省略できないケース
クラスメソッドを使う場合は`self`を省略することができません。※
どういうことか詳しく見ていきましょう
```ruby:self2.rb
class MyClass
  def self.greet
    "Hello from the class!"
  end
end
puts MyClass.greet  # => "Hello from the class!"
```

この例では、`greet`メソッドを`self.greet`と定義しています。
これにより、`greet`はクラスメソッドになり、`MyClass`というクラス自身に対して呼び出すことができます。
※クラス名を直接使って定義する方法もあり`def MyClass.greet`と書くことでもクラスメソッドを定義できます

この場合、`greet`の前に`self`を置かないとエラーになります。なぜでしょうか。

### クラスメソッドでselfが必要な理由
Rubyでは、クラス内でメソッドを定義する際に、何も指定しなければそのメソッドはインスタンスメソッドとして定義されます。
インスタンスメソッドの場合、インスタンスが暗黙のレシーバとなるため、`self`を省略してもインスタンスが自動的にレシーバとして認識されます。

一方で、クラスメソッドを定義する際には、クラス自体がレシーバになることを明確にする必要があります。クラスメソッドの場合、`self`はクラスそのものを指します。`self.greet`と書くことで、`greet`メソッドがインスタンスではなくクラスに対して実行されることを示します。

もし`self`を付けずに単に`greet`と書いてしまうと、Rubyはそれをインスタンスメソッドとして解釈しようとし、エラーが発生します。なぜなら、この場合、レシーバとなるインスタンスが存在しないからです。

### クラスメソッドとインスタンスメソッドの違い
ここで、クラスメソッドとインスタンスメソッドの違いを改めて整理します。
クラスメソッドはクラスそのものに属するメソッドであり、クラスに対して直接呼び出されます。
一方、インスタンスメソッドはクラスのインスタンス（オブジェクト）に属し、そのインスタンスに対して呼び出されます。

クラスメソッド: `MyClass.greet`
インスタンスメソッド: `my_instance.greet`
この違いを意識することで、`self`が必要なタイミングをより正確に理解できるようになります。

もしクラスメソッドとインスタンスメソッドの違いについて知りたい方は、記事を書いているのでそちらを見ていただけたら幸いです

https://qiita.com/Taira0222/items/aca062a0cfb879fded31

# まとめ
今回の記事では、レシーバと`self`の役割や使い方について説明しました。
レシーバは「どのオブジェクトがメソッドを実行するか」を決め、`self`はそのレシーバを明示的に指し示すものです。
また、クラスメソッドとインスタンスメソッドの違いも把握することで、`self`をどのように使うべきかがよりクリアになったと思います。
